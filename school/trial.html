<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>体験レッスン申し込み｜花城音楽教室</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Sawarabi+Gothic&family=M+PLUS+1p:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../assets/style.css">
  <style>
    .hidden { display: none !important; }
    .disabled-label { color: #bbb !important; cursor: not-allowed !important; opacity: 0.7; }
    .contact-block { margin-top: 1.5rem; }
    .contact-img { display: block; margin: 1em auto 0 auto; max-width: 240px; }
    .time-group-wrap { margin-bottom: 1.3em; }
    .contact-note { font-size: .95em; color: #888; margin-top: .7em; line-height: 1.4; }
  </style>
</head>
<body>
  <div class="wrapper">
    <main>
      <section id="trial-form" class="section">
        <h2>体験レッスン申し込みフォーム</h2>
        <form action="/submit-trial" method="post" class="trial-form">
          <!-- お名前 -->
          <div class="form-block">
            <div class="form-label-title">
              <span class="form-label-bar"></span>お名前 <span class="form-required">必須</span>
            </div>
            <div class="form-group">
              <label for="lastname">姓</label>
              <input type="text" id="lastname" name="lastname" required>
            </div>
            <div class="form-group">
              <label for="firstname">名</label>
              <input type="text" id="firstname" name="firstname" required>
            </div>
          </div>
          <!-- ふりがな -->
          <div class="form-block">
            <div class="form-label-title">
              <span class="form-label-bar"></span>ふりがな <span class="form-required">必須</span>
            </div>
            <div class="form-group">
              <label for="furigana-last">せい</label>
              <input type="text" id="furigana-last" name="furigana_last" required>
            </div>
            <div class="form-group">
              <label for="furigana-first">めい</label>
              <input type="text" id="furigana-first" name="furigana_first" required>
            </div>
          </div>
          <!-- 年齢 -->
          <div class="form-block">
            <div class="form-label-title">
              <span class="form-label-bar"></span>年齢 <span class="form-required">必須</span>
            </div>
            <div class="form-group">
              <select id="age" name="age" required>
                <option value="">選択してください</option>
                <option>〜9歳</option>
                <option>10〜19歳</option>
                <option>20〜29歳</option>
                <option>30〜39歳</option>
                <option>40〜49歳</option>
                <option>50〜59歳</option>
                <option>60歳〜</option>
              </select>
            </div>
          </div>
          <!-- 性別 -->
          <div class="form-block">
            <div class="form-label-title">
              <span class="form-label-bar"></span>性別 <span class="form-required">必須</span>
            </div>
            <div class="radio-group">
              <label><input type="radio" name="gender" value="男性" required> 男性</label>
              <label><input type="radio" name="gender" value="女性"> 女性</label>
              <label><input type="radio" name="gender" value="その他"> その他</label>
            </div>
          </div>
          <!-- 希望するコース -->
          <div class="form-block">
            <div class="form-label-title">
              <span class="form-label-bar"></span>希望するコース <span class="form-required">必須</span>
            </div>
            <div class="form-group">
              <select id="course" name="course" required>
                <option value="">選択してください</option>
                <option value="ピアノ">ピアノ</option>
                <option value="ピアノ弾き語り">ピアノ弾き語り</option>
                <option value="ボイストレーニング">ボイストレーニング</option>
              </select>
            </div>
          </div>
          <!-- コースごとの理由（動的表示） -->
          <div id="reason-block-piano" class="form-block hidden">
            <div class="form-label-title">
              <span class="form-label-bar"></span>レッスンを希望する理由 <span class="form-required">必須</span>
            </div>
            <div class="form-caption">※複数回答可</div>
            <div class="checkbox-group">
              <label><input type="checkbox" name="reason_piano" value="好きな曲を弾きたい"> 好きな曲を弾きたい</label>
              <label><input type="checkbox" name="reason_piano" value="楽譜が読めるようになりたい"> 楽譜が読めるようになりたい</label>
              <label><input type="checkbox" name="reason_piano" value="姿勢や指使いなど基礎から身につけたい"> 姿勢や指使いなど基礎から身につけたい</label>
              <label><input type="checkbox" name="reason_piano" value="趣味として気軽に楽しみたい"> 趣味として気軽に楽しみたい</label>
              <label><input type="checkbox" name="reason_piano" value="伴奏やコード弾きができるようになりたい"> 伴奏やコード弾きができるようになりたい</label>
              <label><input type="checkbox" name="reason_piano" value="作曲・アレンジに活かしたい"> 作曲・アレンジに活かしたい</label>
              <label><input type="checkbox" name="reason_piano" value="人前で演奏する目標に挑戦したい"> 人前で演奏する目標に挑戦したい</label>
              <label><input type="checkbox" name="reason_piano" value="スキルアップや音大受験を視野に学びたい"> スキルアップや音大受験を視野に学びたい</label>
              <label><input type="checkbox" name="reason_piano" value="お子さんの習い事・情操教育として"> お子さんの習い事・情操教育として</label>
              <label><input type="checkbox" name="reason_piano" value="その他"> その他</label>
            </div>
            <div class="form-group">
              <label for="reason_piano_etc">その他理由</label>
              <textarea id="reason_piano_etc" name="reason_piano_etc"></textarea>
            </div>
          </div>
          <div id="reason-block-singplay" class="form-block hidden">
            <div class="form-label-title">
              <span class="form-label-bar"></span>レッスンを希望する理由 <span class="form-required">必須</span>
            </div>
            <div class="form-caption">※複数回答可</div>
            <div class="checkbox-group">
              <label><input type="checkbox" name="reason_singplay" value="好きな曲を弾き語りしたい"> 好きな曲を弾き語りしたい</label>
              <label><input type="checkbox" name="reason_singplay" value="コードで弾けるようになりたい"> コードで弾けるようになりたい</label>
              <label><input type="checkbox" name="reason_singplay" value="趣味としてゆったり楽しみたい"> 趣味としてゆったり楽しみたい</label>
              <label><input type="checkbox" name="reason_singplay" value="自作の歌を弾き語りで表現したい"> 自作の歌を弾き語りで表現したい</label>
              <label><input type="checkbox" name="reason_singplay" value="ライブ・発表会に向けて準備したい"> ライブ・発表会に向けて準備したい</label>
              <label><input type="checkbox" name="reason_singplay" value="弾き語り動画をSNSに投稿したい"> 弾き語り動画をSNSに投稿したい</label>
              <label><input type="checkbox" name="reason_singplay" value="音楽活動に必要なスキルを身につけたい"> 音楽活動に必要なスキルを身につけたい</label>
              <label><input type="checkbox" name="reason_singplay" value="歌に合ったコードやアレンジを学びたい"> 歌に合ったコードやアレンジを学びたい</label>
              <label><input type="checkbox" name="reason_singplay" value="声の出し方や発声も一緒に学びたい"> 声の出し方や発声も一緒に学びたい</label>
              <label><input type="checkbox" name="reason_singplay" value="その他"> その他</label>
            </div>
            <div class="form-group">
              <label for="reason_singplay_etc">その他理由</label>
              <textarea id="reason_singplay_etc" name="reason_singplay_etc"></textarea>
            </div>
          </div>
          <div id="reason-block-voice" class="form-block hidden">
            <div class="form-label-title">
              <span class="form-label-bar"></span>レッスンを希望する理由 <span class="form-required">必須</span>
            </div>
            <div class="form-caption">※複数回答可</div>
            <div class="checkbox-group">
              <label><input type="checkbox" name="reason_voice" value="好きな歌を歌えるようになりたい"> 好きな歌を歌えるようになりたい</label>
              <label><input type="checkbox" name="reason_voice" value="音程を安定させたい"> 音程を安定させたい</label>
              <label><input type="checkbox" name="reason_voice" value="高い声を出せるようになりたい"> 高い声を出せるようになりたい</label>
              <label><input type="checkbox" name="reason_voice" value="喉が枯れない歌い方を知りたい"> 喉が枯れない歌い方を知りたい</label>
              <label><input type="checkbox" name="reason_voice" value="カラオケでもっと上手く歌いたい"> カラオケでもっと上手く歌いたい</label>
              <label><input type="checkbox" name="reason_voice" value="人前で歌う機会に向けて練習したい"> 人前で歌う機会に向けて練習したい</label>
              <label><input type="checkbox" name="reason_voice" value="滑舌や発音を良くしたい"> 滑舌や発音を良くしたい</label>
              <label><input type="checkbox" name="reason_voice" value="声が小さい・通らないのが悩み"> 声が小さい・通らないのが悩み</label>
              <label><input type="checkbox" name="reason_voice" value="その他"> その他</label>
            </div>
            <div class="form-group">
              <label for="reason_voice_etc">その他理由</label>
              <textarea id="reason_voice_etc" name="reason_voice_etc"></textarea>
            </div>
          </div>
          <!-- レッスンを希望する曜日・時間帯 -->
          <div class="form-block">
            <div class="form-label-title">
              <span class="form-label-bar"></span>
              レッスンを希望する曜日・時間帯 <span class="form-required">必須</span>
            </div>
            <div class="checkbox-group" id="weekday-group">
              <label><input type="checkbox" name="weekday" value="月曜日"> 月曜日</label>
              <label><input type="checkbox" name="weekday" value="火曜日"> 火曜日</label>
              <label><input type="checkbox" name="weekday" value="水曜日"> 水曜日</label>
              <label><input type="checkbox" name="weekday" value="木曜日"> 木曜日</label>
              <label><input type="checkbox" name="weekday" value="金曜日"> 金曜日</label>
              <label><input type="checkbox" name="weekday" value="土曜日"> 土曜日</label>
              <label><input type="checkbox" name="weekday" value="日曜日"> 日曜日</label>
            </div>
            <div id="time-group-list"></div>
            <div class="form-group">
              <label for="free-request">要相談（自由記入）</label>
              <textarea id="free-request" name="free_request"></textarea>
            </div>
          </div>
          <!-- ご希望の連絡方法と分岐ブロック -->
          <div class="form-block">
            <div class="form-label-title">
              <span class="form-label-bar"></span>ご希望の連絡方法 <span class="form-required">必須</span>
            </div>
            <div class="radio-group" id="contact-method-group">
              <label><input type="radio" name="contact_method" value="電話" required> 電話</label>
              <label><input type="radio" name="contact_method" value="メール"> メール</label>
              <label><input type="radio" name="contact_method" value="LINE"> LINE</label>
              <label><input type="radio" name="contact_method" value="Instagram DM"> Instagram DM</label>
            </div>
            <!-- 電話 -->
            <div class="contact-block hidden" id="contact-phone">
              <div class="form-group">
                <label for="contact-phone-tel">お電話番号 <span class="form-required">必須</span></label>
                <input type="tel" id="contact-phone-tel" name="contact_phone_tel" pattern="\d{10,11}">
              </div>
              <div class="form-group">
                <label>ご都合の良いお時間帯（任意）</label>
                <div class="checkbox-group">
                  <label><input type="checkbox" name="contact_phone_time" value="午前"> 午前（10:00～12:00）</label>
                  <label><input type="checkbox" name="contact_phone_time" value="午後"> 午後（13:00～16:00）</label>
                  <label><input type="checkbox" name="contact_phone_time" value="夕方"> 夕方（16:00～19:00）</label>
                  <label><input type="checkbox" name="contact_phone_time" value="夜間"> 夜間（19:00～21:00）</label>
                </div>
              </div>
              <div class="contact-note">
                体験レッスンお申し込み後、３日以内に代表・花城よりお電話いたします。<br>
                もし３日以上経ってもご連絡がない場合は、お申し込みが届いていない可能性がありますので、恐れ入りますが再度お申し込みください。
              </div>
            </div>
            <!-- メール -->
            <div class="contact-block hidden" id="contact-mail">
              <div class="form-group">
                <label for="contact-mail-address">メールアドレス <span class="form-required">必須</span></label>
                <input type="email" id="contact-mail-address" name="contact_mail_address">
              </div>
              <div class="contact-note">
                体験レッスンお申し込み後、３日以内に教室公式メール（hanashiro.music.school@gmail.com）よりご連絡いたします。<br>
                万が一届かない場合は、迷惑メールフォルダをご確認のうえ、再度お申し込みください。
              </div>
            </div>
            <!-- LINE -->
            <div class="contact-block hidden" id="contact-line">
              <div class="form-group">
                <label for="contact-line-name">LINEアカウント名 <span class="form-required">必須</span></label>
                <input type="text" id="contact-line-name" name="contact_line_name">
              </div>
              <div class="contact-note">
                以下の公式LINEを【友だち追加】し、トークで「体験レッスン希望」とメッセージをお送りください。<br>
                その後、こちらからご連絡いたします。<br>
                ※教室側からお客様を一方的に追加できない仕組みのため、お手数ですが必ずご自身で友だち追加をお願いいたします。<br>
                <a href="https://lin.ee/＊＊＊＊＊" target="_blank"><img src="../assets/line.jpeg" alt="花城音楽教室 公式LINE" class="contact-img"></a>
              </div>
            </div>
            <!-- Instagram DM -->
            <div class="contact-block hidden" id="contact-insta">
              <div class="form-group">
                <label for="contact-insta-name">Instagramアカウント名 <span class="form-required">必須</span></label>
                <input type="text" id="contact-insta-name" name="contact_insta_name">
              </div>
              <div class="contact-note">
                教室公式アカウント（@hanashiro_music_school）をフォローのうえ、DMで「体験レッスン希望」とご連絡ください。<br>
                ※非公開アカウントでもDMは送れますが、「メッセージリクエスト」として届くため、承認されないと見られない場合があります。<br>
                <a href="https://instagram.com/hanashiro_music_school" target="_blank"><img src="../assets/instagram.png" alt="花城音楽教室 Instagram" class="contact-img"></a>
              </div>
            </div>
          </div>
          <!-- 送信ボタン -->
          <div class="submit-group">
            <button type="submit" class="btn-submit">送信内容の確認</button>
          </div>
        </form>
      </section>
    </main>
    <footer class="site-footer">
      <p>&copy; 2025 Hanashiro Music School. All rights reserved.</p>
    </footer>
  </div>
  <!-- 分岐js -->
  <script>
document.addEventListener("DOMContentLoaded", function(){
  // コース分岐
  const courseSelect = document.getElementById('course');
  const reasonBlocks = {
    "ピアノ": document.getElementById('reason-block-piano'),
    "ピアノ弾き語り": document.getElementById('reason-block-singplay'),
    "ボイストレーニング": document.getElementById('reason-block-voice')
  };
  courseSelect.addEventListener('change', function(){
    Object.values(reasonBlocks).forEach(el => el.classList.add('hidden'));
    if (reasonBlocks[courseSelect.value]) {
      reasonBlocks[courseSelect.value].classList.remove('hidden');
    }
  });

  // 曜日→時間分岐
  const weekdayGroup = document.getElementById('weekday-group');
  const timeGroupList = document.getElementById('time-group-list');
  const dayTimeDefs = {
    "月曜日":   [["午前（10:00～12:00）", true], ["午後（13:00～16:00）", true], ["夕方（16:00～19:00）", true], ["夜間（19:00～21:00）", true]],
    "火曜日":   [["午前（10:00～12:00）", true], ["午後（13:00～16:00）", true], ["夕方（16:00～19:00）", true], ["夜間（19:00～21:00）", true]],
    "水曜日":   [["午前（10:00～12:00）", true], ["午後（13:00～16:00）", true], ["夕方（16:00～19:00）", true], ["夜間（19:00～21:00）", true]],
    "木曜日":   [["午前（10:00～12:00）", true], ["午後（13:00～16:00）", true], ["夕方（16:00～19:00）", false], ["夜間（19:00～21:00）", false]],
    "金曜日":   [["午前（10:00～12:00）", false], ["午後（13:00～16:00）", false], ["夕方（16:00～19:00）", true], ["夜間（19:00～21:00）", true]],
    "土曜日":   [["午前（9:00～12:00）", true], ["午後（13:00～16:00）", false], ["夕方（16:00～19:00）", false], ["夜間（19:00～21:00）", true]],
    "日曜日":   [["午前（10:00～12:00）", false], ["午後（13:00～16:00）", false], ["夕方（16:00～19:00）", false], ["夜間（19:00～21:00）", true]],
  };
  function updateTimeGroups(){
    timeGroupList.innerHTML = "";
    Array.from(weekdayGroup.querySelectorAll('input[type="checkbox"]')).forEach(checkbox => {
      if(checkbox.checked){
        const weekday = checkbox.value;
        const def = dayTimeDefs[weekday];
        if(def){
          let html = `<div class="time-group-wrap"><strong>${weekday}：</strong><div class="checkbox-group">`;
          def.forEach(([label, enabled], idx) => {
            if(enabled){
              html += `<label><input type="checkbox" name="time_${weekday}" value="${label}">${label}</label>`;
            }else{
              html += `<label class="disabled-label">${label}</label>`;
            }
          });
          html += "</div></div>";
          timeGroupList.insertAdjacentHTML("beforeend", html);
        }
      }
    });
  }
  weekdayGroup.addEventListener('change', updateTimeGroups);

  // 連絡方法分岐（空白・全角にも強く）
  const contactRadios = document.querySelectorAll('input[name="contact_method"]');
  const contactBlocks = {
    "電話": document.getElementById("contact-phone"),
    "メール": document.getElementById("contact-mail"),
    "LINE": document.getElementById("contact-line"),
    "InstagramDM": document.getElementById("contact-insta") // 空白無し
  };
  contactRadios.forEach(radio => {
    radio.addEventListener('change', function(){
      Object.values(contactBlocks).forEach(el=>{if(el)el.classList.add('hidden')});
      // value正規化（全角スペースや半角空白、全て除去）
      let key = this.value.replace(/\s+/g, '').replace(/　/g, '');
      if(key === "InstagramDM") key = "InstagramDM"; // 特別処理
      if(contactBlocks[key]){
        contactBlocks[key].classList.remove('hidden');
      }
    });
  });
});
  </script>
</body>
</html>