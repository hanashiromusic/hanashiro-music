<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>体験レッスン申し込み｜花城音楽教室</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Google Fonts: Sawarabi Gothic & M PLUS 1p -->
<link href="https://fonts.googleapis.com/css2?
  family=Sawarabi+Mincho&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Sawarabi+Gothic&family=M+PLUS+1p:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../assets/style.css">
  <style>
    body {
      background: #bed3da;
      color: #333;
      font-family: "Sawarabi Gothic", "M PLUS 1p", sans-serif;
      line-height: 1.6;
      padding: 1rem;
    }
    .wrapper {
      width: 100%;
      max-width: 960px;
      margin: 1.5rem auto;
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 4px 12px rgba(0,0,0,.08);
      padding: 3rem;
    }
    @media (max-width: 480px) {
      .wrapper { padding: 2rem 1.5rem; }
    }
    .menu-toggle {
      position: fixed;
      top: 1rem;
      right: 1rem;
      width: 2.5rem;
      height: 2.5rem;
      background: #bed3da;
      border: none;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: .3rem;
      cursor: pointer;
      z-index: 200;
    }
    .menu-toggle span { width: 60%; height: 3px; background: #fff; border-radius: 2px; transition: background-color .3s; }
    .menu-toggle.open { background: #333; }
    .menu-toggle.open span { background: #fff; }
    .section-nav {
      position: fixed;
      top: 0;
      right: 0;
      width: 80%;
      max-width: 320px;
      height: 100%;
      background: rgba(255,255,255,.95);
      padding: 4rem 1.5rem;
      overflow-y: auto;
      z-index: 150;
      display: flex;
      flex-direction: column;
      gap: 1rem;
      transform: translateX(100%);
      transition: transform .4s cubic-bezier(.77,0,.18,1);
    }
    .section-nav.open { transform: translateX(0); }
    .section-nav a {
      display: block;
      margin: .5rem 0;
      padding: .8rem;
      background: #bed3da;
      color: #000;
      text-decoration: none;
      border-radius: 6px;
      text-align: center;
      font-weight: 600;
    }
    .section h2 {
      font-family: "M PLUS 1p", sans-serif;
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 2.2rem;
      text-align: center;
    }
    @media (max-width: 480px) {
      .section h2 { font-size: 1.3rem; }
    }
    .form-block { margin-bottom: 2.1rem; padding: 0; border: none; background: none; }
    .form-label-title {
      display: flex;
      align-items: center;
      font-family: "M PLUS 1p", sans-serif;
      font-size: 1.13rem;
      font-weight: 700;
      margin-bottom: .5rem;
      line-height: 1.1;
    }
    .form-label-bar {
      width: 5px;
      height: 1.6em;
      background: #bed3da;
      border-radius: 3px;
      margin-right: .6em;
    }
    .form-required {
      display: inline-block;
      background: #bed3da;
      color: #fff;
      font-size: .88em;
      font-weight: 500;
      border-radius: 1em;
      padding: .08em .85em .07em .85em;
      margin-left: .75em;
      letter-spacing: .04em;
    }
    .form-caption {
      font-size: .95em;
      color: #888;
      margin: 0 0 .3em 2.3em;
      line-height: 1.1;
    }
    @media (max-width: 480px) {
      .form-caption { margin-left: 1.8em; font-size: .89em; }
    }
    .trial-form label { display: block; font-size: 1em; font-weight: 500; margin-bottom: .12em; }
    .trial-form input,
    .trial-form select,
    .trial-form textarea {
      width: 100%;
      padding: .68rem .7rem;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
      background: #fff;
      margin-top: .1em;
    }
    .trial-form textarea { min-height: 100px; resize: vertical; }
    .radio-group,
    .checkbox-group {
      display: flex;
      flex-wrap: wrap;
      gap: 1.4em 1em;
      margin-bottom: .7em;
    }
    .radio-group label,
    .checkbox-group label {
      display: flex;
      align-items: center;
      font-weight: 500;
      margin-right: 1.2em;
    }
    .radio-group input,
    .checkbox-group input {
      margin-right: .5em;
      accent-color: #A66B75;
      width: 1.1em;
      height: 1.1em;
    }
    .submit-group { text-align: center; margin-top: 2.8rem; }
    .btn-submit {
      display: inline-block;
      padding: 1.15rem 2.7rem;
      background: #A66B75;
      color: #fff;
      border: none;
      border-radius: 2em;
      font-size: 1.22rem;
      font-weight: 700;
      letter-spacing: .1em;
      box-shadow: 0 2px 8px rgba(166,107,117,.09);
      cursor: pointer;
      transition: opacity .14s;
    }
    .btn-submit:hover,
    .btn-submit:focus { opacity: .92; }
    .site-footer {
      text-align: center;
      font-size: .91rem;
      color: #333;
      margin-top: 2.4rem;
    }
    /* --------- 追加分 --------- */
    .hidden { display: none !important; }
    .disabled-label { color: #bbb !important; cursor: not-allowed !important; opacity: 0.7; }
    .contact-block { margin-top: 1.5rem; }
    .contact-img { display: block; margin: 1em auto 0 auto; max-width: 240px; }
    .time-group-wrap { margin-bottom: 1.3em; }
    .contact-note { font-size: .95em; color: #888; margin-top: .7em; line-height: 1.4; }
    /* モーダル用 */
    #confirm-modal {
      position: fixed;
      left: 0; top: 0; right: 0; bottom: 0;
      z-index: 5000;
      background: rgba(0,0,0,.23);
      display: flex;
      justify-content: center;
      align-items: center;
    }
    #confirm-modal.hidden { display: none !important; }
    .confirm-box {
      background: #fff;
      border-radius: 18px;
      max-width: 420px;
      width: 92vw;
      padding: 2.1rem 1.2rem 1.4rem 1.2rem;
      box-shadow: 0 8px 40px rgba(120,120,120,.21);
      font-size: 1.04rem;
      animation: fadeInUp .25s;
    }
    .confirm-box h3 { text-align: center; font-size: 1.3rem; margin-bottom: 1.3em; font-family:"M PLUS 1p",sans-serif; }
    .btn-cancel { margin-left: 1.5em; color: #A66B75; background: none; border: 1px solid #A66B75; border-radius: 2em; padding: .8em 1.4em; font-size: 1rem; font-weight: 700; cursor: pointer; }
    .btn-cancel:hover { background: #eee; }
  </style>
</head>
<body>
  <div class="wrapper">

    <!-- ハンバーガー＆ナビ -->
    <button class="menu-toggle" aria-label="メニューを開く">
      <span></span><span></span><span></span>
    </button>
    <nav class="section-nav">
      <a href="https://hanashiromusic.com/school/">HOME</a>
      <a href="https://hanashiromusic.com/school/#course-overview">コース紹介</a>
      <a href="https://hanashiromusic.com/school/#fee">レッスン料金</a>
      <a href="https://hanashiromusic.com/school/#access">アクセス</a>
      <a href="https://hanashiromusic.com/school/#teacher">講師紹介</a>
      <a href="https://hanashiromusic.com/school/trial">無料体験レッスン<br>申し込みはこちら</a>
    </nav>

    <main>
      <section id="trial-form" class="section">
        <h2>無料体験レッスン<br>申し込みフォーム</h2>
        <form action="https://formspree.io/f/movlelvy" method="POST" class="trial-form">
          <input type="hidden" name="_redirect" value="https://hanashiromusic.com/school/thanks.html">
          <!-- お名前 -->
          <div class="form-block">
            <div class="form-label-title">
              <span class="form-label-bar"></span>
              お名前
              <span class="form-required">必須</span>
            </div>
            <div class="form-group">
              <label for="lastname">姓</label>
              <input type="text" id="lastname" name="lastname" required>
            </div>
            <div class="form-group">
              <label for="firstname">名</label>
              <input type="text" id="firstname" name="firstname" required>
            </div>
          </div>
          <!-- ふりがな -->
          <div class="form-block">
            <div class="form-label-title">
              <span class="form-label-bar"></span>
              ふりがな
              <span class="form-required">必須</span>
            </div>
            <div class="form-group">
              <label for="furigana-last">せい</label>
              <input type="text" id="furigana-last" name="furigana_last" required>
            </div>
            <div class="form-group">
              <label for="furigana-first">めい</label>
              <input type="text" id="furigana-first" name="furigana_first" required>
            </div>
          </div>
          <!-- 年齢 -->
          <div class="form-block">
            <div class="form-label-title">
              <span class="form-label-bar"></span>
              年齢
              <span class="form-required">必須</span>
            </div>
            <div class="form-group">
              <select id="age" name="age" required>
                <option value="">選択してください</option>
                <option>〜9歳</option>
                <option>10〜19歳</option>
                <option>20〜29歳</option>
                <option>30〜39歳</option>
                <option>40〜49歳</option>
                <option>50〜59歳</option>
                <option>60歳〜</option>
              </select>
            </div>
          </div>
          <!-- 性別 -->
          <div class="form-block">
            <div class="form-label-title">
              <span class="form-label-bar"></span>
              性別
              <span class="form-required">必須</span>
            </div>
            <div class="radio-group">
              <label><input type="radio" name="gender" value="男性" required> 男性</label>
              <label><input type="radio" name="gender" value="女性"> 女性</label>
              <label><input type="radio" name="gender" value="その他"> その他</label>
            </div>
          </div>
          <!-- 希望するコース -->
          <div class="form-block">
            <div class="form-label-title">
              <span class="form-label-bar"></span>希望するコース <span class="form-required">必須</span>
            </div>
            <div class="form-group">
              <select id="course" name="course" required>
                <option value="">選択してください</option>
                <option value="ピアノ">ピアノ</option>
                <option value="ピアノ弾き語り">ピアノ弾き語り</option>
                <option value="ボイストレーニング">ボイストレーニング</option>
              </select>
            </div>
          </div>
          <!-- コースごとの理由（動的表示） -->
          <div id="reason-block-piano" class="form-block hidden">
            <div class="form-label-title">
              <span class="form-label-bar"></span>レッスンを希望する理由 <span class="form-required">必須</span>
            </div>
            <div class="form-caption">※複数回答可</div>
            <div class="checkbox-group">
              <label><input type="checkbox" name="reason_piano" value="好きな曲を弾きたい"> 好きな曲を弾きたい</label>
              <label><input type="checkbox" name="reason_piano" value="楽譜が読めるようになりたい"> 楽譜が読めるようになりたい</label>
              <label><input type="checkbox" name="reason_piano" value="姿勢や指使いなど基礎から身につけたい"> 姿勢や指使いなど基礎から身につけたい</label>
              <label><input type="checkbox" name="reason_piano" value="趣味として気軽に楽しみたい"> 趣味として気軽に楽しみたい</label>
              <label><input type="checkbox" name="reason_piano" value="伴奏やコード弾きができるようになりたい"> 伴奏やコード弾きができるようになりたい</label>
              <label><input type="checkbox" name="reason_piano" value="作曲・アレンジに活かしたい"> 作曲・アレンジに活かしたい</label>
              <label><input type="checkbox" name="reason_piano" value="人前で演奏する目標に挑戦したい"> 人前で演奏する目標に挑戦したい</label>
              <label><input type="checkbox" name="reason_piano" value="スキルアップや音大受験を視野に学びたい"> スキルアップや音大受験を視野に学びたい</label>
              <label><input type="checkbox" name="reason_piano" value="お子さんの習い事・情操教育として"> お子さんの習い事・情操教育として</label>
              <label><input type="checkbox" name="reason_piano" value="その他"> その他</label>
            </div>
            <div class="form-group">
              <label for="reason_piano_etc">その他理由</label>
              <textarea id="reason_piano_etc" name="reason_piano_etc"></textarea>
            </div>
          </div>
          <div id="reason-block-singplay" class="form-block hidden">
            <div class="form-label-title">
              <span class="form-label-bar"></span>レッスンを希望する理由 <span class="form-required">必須</span>
            </div>
            <div class="form-caption">※複数回答可</div>
            <div class="checkbox-group">
              <label><input type="checkbox" name="reason_singplay" value="好きな曲を弾き語りしたい"> 好きな曲を弾き語りしたい</label>
              <label><input type="checkbox" name="reason_singplay" value="コードで弾けるようになりたい"> コードで弾けるようになりたい</label>
              <label><input type="checkbox" name="reason_singplay" value="趣味としてゆったり楽しみたい"> 趣味としてゆったり楽しみたい</label>
              <label><input type="checkbox" name="reason_singplay" value="自作の歌を弾き語りで表現したい"> 自作の歌を弾き語りで表現したい</label>
              <label><input type="checkbox" name="reason_singplay" value="ライブ・発表会に向けて準備したい"> ライブ・発表会に向けて準備したい</label>
              <label><input type="checkbox" name="reason_singplay" value="弾き語り動画をSNSに投稿したい"> 弾き語り動画をSNSに投稿したい</label>
              <label><input type="checkbox" name="reason_singplay" value="音楽活動に必要なスキルを身につけたい"> 音楽活動に必要なスキルを身につけたい</label>
              <label><input type="checkbox" name="reason_singplay" value="歌に合ったコードやアレンジを学びたい"> 歌に合ったコードやアレンジを学びたい</label>
              <label><input type="checkbox" name="reason_singplay" value="声の出し方や発声も一緒に学びたい"> 声の出し方や発声も一緒に学びたい</label>
              <label><input type="checkbox" name="reason_singplay" value="その他"> その他</label>
            </div>
            <div class="form-group">
              <label for="reason_singplay_etc">その他理由</label>
              <textarea id="reason_singplay_etc" name="reason_singplay_etc"></textarea>
            </div>
          </div>
          <div id="reason-block-voice" class="form-block hidden">
            <div class="form-label-title">
              <span class="form-label-bar"></span>レッスンを希望する理由 <span class="form-required">必須</span>
            </div>
            <div class="form-caption">※複数回答可</div>
            <div class="checkbox-group">
              <label><input type="checkbox" name="reason_voice" value="好きな歌を歌えるようになりたい"> 好きな歌を歌えるようになりたい</label>
              <label><input type="checkbox" name="reason_voice" value="音程を安定させたい"> 音程を安定させたい</label>
              <label><input type="checkbox" name="reason_voice" value="高い声を出せるようになりたい"> 高い声を出せるようになりたい</label>
              <label><input type="checkbox" name="reason_voice" value="喉が枯れない歌い方を知りたい"> 喉が枯れない歌い方を知りたい</label>
              <label><input type="checkbox" name="reason_voice" value="カラオケでもっと上手く歌いたい"> カラオケでもっと上手く歌いたい</label>
              <label><input type="checkbox" name="reason_voice" value="人前で歌う機会に向けて練習したい"> 人前で歌う機会に向けて練習したい</label>
              <label><input type="checkbox" name="reason_voice" value="滑舌や発音を良くしたい"> 滑舌や発音を良くしたい</label>
              <label><input type="checkbox" name="reason_voice" value="声が小さい・通らないのが悩み"> 声が小さい・通らないのが悩み</label>
              <label><input type="checkbox" name="reason_voice" value="その他"> その他</label>
            </div>
            <div class="form-group">
              <label for="reason_voice_etc">その他理由</label>
              <textarea id="reason_voice_etc" name="reason_voice_etc"></textarea>
            </div>
          </div>
          <!-- レッスンを希望する曜日・時間帯 -->
          <div class="form-block">
            <div class="form-label-title">
              <span class="form-label-bar"></span>
              体験レッスン希望曜日・時間帯 <span class="form-required">必須</span>
             <div class="form-caption">※複数回答可</div>
               
            </div>
            <div class="checkbox-group" id="weekday-group">
              <label><input type="checkbox" name="weekday" value="月曜日"> 月曜日</label>
              <label><input type="checkbox" name="weekday" value="火曜日"> 火曜日</label>
              <label><input type="checkbox" name="weekday" value="水曜日"> 水曜日</label>
              <label><input type="checkbox" name="weekday" value="木曜日"> 木曜日</label>
              <label><input type="checkbox" name="weekday" value="金曜日"> 金曜日</label>
              <label><input type="checkbox" name="weekday" value="土曜日"> 土曜日</label>
              <label><input type="checkbox" name="weekday" value="日曜日"> 日曜日</label>
            </div>
            <div id="time-group-list"></div>
            <div class="form-group">
              <label for="free-request">要相談（自由記入）</label>
              <textarea id="free-request" name="free_request"></textarea>
            </div>
          </div>
          <!-- ご希望の連絡方法と分岐ブロック -->
          <div class="form-block">
            <div class="form-label-title">
              <span class="form-label-bar"></span>ご希望の連絡方法 <span class="form-required">必須</span>
            </div>
            <div class="radio-group" id="contact-method-group">
              <label><input type="radio" name="contact_method" value="電話" required> 電話</label>
              <label><input type="radio" name="contact_method" value="メール"> メール</label>
              <label><input type="radio" name="contact_method" value="LINE"> LINE</label>
              <label><input type="radio" name="contact_method" value="Instagram DM"> Instagram DM</label>
            </div>
            <!-- 電話 -->
            <div class="contact-block hidden" id="contact-phone">
              <div class="form-group">
                <label for="contact-phone-tel">お電話番号 <span class="form-required">必須</span></label>
                <input type="tel" id="contact-phone-tel" name="contact_phone_tel" pattern="\d{10,11}">
              </div>
              <div class="form-group">
                <label>ご都合の良いお時間帯（任意）</label>
                <div class="checkbox-group">
                  <label><input type="checkbox" name="contact_phone_time" value="午前"> 午前（10:00～12:00）</label>
                  <label><input type="checkbox" name="contact_phone_time" value="午後"> 午後（13:00～16:00）</label>
                  <label><input type="checkbox" name="contact_phone_time" value="夕方"> 夕方（16:00～19:00）</label>
                  <label><input type="checkbox" name="contact_phone_time" value="夜間"> 夜間（19:00～21:00）</label>
                </div>
              </div>
              <div class="contact-note">
                体験レッスンお申し込み後、３日以内に代表・花城よりお電話いたします。<br>
                もし３日以上経ってもご連絡がない場合は、お申し込みが届いていない可能性がありますので、恐れ入りますが再度お申し込みください。
              </div>
            </div>
            <!-- メール -->
            <div class="contact-block hidden" id="contact-mail">
              <div class="form-group">
                <label for="contact-mail-address">メールアドレス <span class="form-required">必須</span></label>
                <input type="email" id="contact-mail-address" name="contact_mail_address">
              </div>
              <div class="contact-note">
                体験レッスンお申し込み後、３日以内に教室公式メール（hanashiro.music.school@gmail.com）よりご連絡いたします。<br>
                万が一届かない場合は、迷惑メールフォルダをご確認のうえ、再度お申し込みください。
              </div>
            </div>
            <!-- LINE -->
            <div class="contact-block hidden" id="contact-line">
              <div class="form-group">
                <label for="contact-line-name">LINEアカウント名 <span class="form-required">必須</span></label>
                <input type="text" id="contact-line-name" name="contact_line_name">
              </div>
              <div class="contact-note">
                以下の公式LINEを【友だち追加】し、トークで「体験レッスン希望」とメッセージをお送りください。<br>
                その後、こちらからご連絡いたします。<br>
                ※教室側からお客様を一方的に追加できない仕組みのため、お手数ですが必ずご自身で友だち追加をお願いいたします。<br>
                <a href="https://line.me/R/ti/p/@857gvbrj" target="_blank"><img src="../assets/line.jpeg" alt="花城音楽教室 公式LINE" class="contact-img"></a>
              </div>
            </div>
            <!-- Instagram DM -->
            <div class="contact-block hidden" id="contact-insta">
              <div class="form-group">
                <label for="contact-insta-name">Instagramアカウント名 <span class="form-required">必須</span></label>
                <input type="text" id="contact-insta-name" name="contact_insta_name">
              </div>
              <div class="contact-note">
                教室公式アカウント（@hanashiro_music_school）をフォローのうえ、DMで「体験レッスン希望」とご連絡ください。<br>
                ※非公開アカウントでもDMは送れますが、「メッセージリクエスト」として届くため、承認されないと見られない場合があります。<br>
                <a href="https://instagram.com/hanashiro_music_school" target="_blank"><img src="../assets/instagram.png" alt="花城音楽教室 Instagram" class="contact-img"></a>
              </div>
            </div>
          </div>
          <!-- 送信ボタン -->
          <div class="submit-group">
            <button type="button" class="btn-submit">送信内容の確認</button>
          </div>
          
          <!-- ▼ ご案内 -------------------------------------------------------- -->
<div class="notice-block">
  <h3><span class="notice-bar"></span>ご案内</h3>
  <p>
    このお申し込み内容は、花城音楽教室の代表が直接受信いたします。<br>
    体験レッスン日時のご案内まで<b>1〜3営業日</b>ほどお時間を頂戴する場合がございますので、あらかじめご了承ください。<br>
      なお、電話番号やメールアドレスの入力間違いや、迷惑メールブロック設定などにより、ご連絡が取れないケースがまれにございます。<br>
    万一 <b>3日以上</b>経っても返信がない場合は、恐れ入りますが迷惑メールフォルダのご確認のうえ、<b>再度フォーム送信</b>をお願いいたします。
  </p>
</div>

<!-- ▼ 個人情報の取り扱いについて ------------------------------------ -->
<div class="notice-block">
  <h3><span class="notice-bar"></span>個人情報の取り扱いについて</h3>
  <p>
    ご入力いただいた個人情報は、花城音楽教室が
    <b>① 体験レッスン受付 ② ご質問への回答</b>
    の目的でのみ利用いたします。<br>
    取得した情報は適切に管理し、お客様の同意なしに第三者へ開示・提供することはございません。
  </p>
</div>
          
        </form>
      </section>
    </main>
    <!-- コピーライト -->
    <footer class="site-footer">
      <p>&copy; 2025 Hanashiro Music School. All rights reserved.</p>
    </footer>
  </div><!-- /.wrapper -->

  <!-- ハンバーガーメニュー動作 -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const btn   = document.querySelector('.menu-toggle');
      const nav   = document.querySelector('.section-nav');
      const links = nav.querySelectorAll('a');
      btn.addEventListener('click', () => {
        const open = nav.classList.toggle('open');
        btn.classList.toggle('open');
        document.body.style.overflow = open ? 'hidden' : '';
        btn.setAttribute('aria-label', open ? 'メニューを閉じる' : 'メニューを開く');
      });
      links.forEach(link =>
        link.addEventListener('click', () => {
          nav.classList.remove('open');
          btn.classList.remove('open');
          document.body.style.overflow = '';
          btn.setAttribute('aria-label', 'メニューを開く');
        })
      );
    });
  </script>
  <!-- 分岐js・モーダルjs -->
  <script>
document.addEventListener("DOMContentLoaded", function(){
  // コース分岐
  const courseSelect = document.getElementById('course');
  const reasonBlocks = {
    "ピアノ": document.getElementById('reason-block-piano'),
    "ピアノ弾き語り": document.getElementById('reason-block-singplay'),
    "ボイストレーニング": document.getElementById('reason-block-voice')
  };
  courseSelect.addEventListener('change', function(){
    Object.values(reasonBlocks).forEach(el => el.classList.add('hidden'));
    if (reasonBlocks[courseSelect.value]) {
      reasonBlocks[courseSelect.value].classList.remove('hidden');
    }
  });

  // 曜日→時間分岐
  const weekdayGroup = document.getElementById('weekday-group');
  const timeGroupList = document.getElementById('time-group-list');
  const dayTimeDefs = {
    "月曜日":   [["午前（10:00～12:00）", true], ["午後（13:00～16:00）", true], ["夕方（16:00～19:00）", true], ["夜間（19:00～21:00）", true]],
    "火曜日":   [["午前（10:00～12:00）", true], ["午後（13:00～16:00）", true], ["夕方（16:00～19:00）", true], ["夜間（19:00～21:00）", true]],
    "水曜日":   [["午前（10:00～12:00）", true], ["午後（13:00～16:00）", true], ["夕方（16:00～19:00）", true], ["夜間（19:00～21:00）", true]],
    "木曜日":   [["午前（10:00～12:00）", true], ["午後（13:00～16:00）", true], ["夕方（16:00～19:00）", false], ["夜間（19:00～21:00）", false]],
    "金曜日":   [["午前（10:00～12:00）", false], ["午後（13:00～16:00）", false], ["夕方（16:00～19:00）", true], ["夜間（19:00～21:00）", true]],
    "土曜日":   [["午前（9:00～12:00）", true], ["午後（13:00～16:00）", false], ["夕方（16:00～19:00）", false], ["夜間（19:00～21:00）", true]],
    "日曜日":   [["午前（10:00～12:00）", false], ["午後（13:00～16:00）", false], ["夕方（16:00～19:00）", false], ["夜間（19:00～21:00）", true]],
  };
  function updateTimeGroups(){
    timeGroupList.innerHTML = "";
    Array.from(weekdayGroup.querySelectorAll('input[type="checkbox"]')).forEach(checkbox => {
      if(checkbox.checked){
        const weekday = checkbox.value;
        const def = dayTimeDefs[weekday];
        if(def){
          let html = `<div class="time-group-wrap"><strong>${weekday}：</strong><div class="checkbox-group">`;
          def.forEach(([label, enabled], idx) => {
            if(enabled){
              html += `<label><input type="checkbox" name="time_${weekday}" value="${label}">${label}</label>`;
            }else{
              html += `<label class="disabled-label">${label}</label>`;
            }
          });
          html += "</div></div>";
          timeGroupList.insertAdjacentHTML("beforeend", html);
        }
      }
    });
  }
  weekdayGroup.addEventListener('change', updateTimeGroups);

  // 連絡方法分岐
  const contactRadios = document.querySelectorAll('input[name="contact_method"]');
  const contactBlocks = {
    "電話": document.getElementById("contact-phone"),
    "メール": document.getElementById("contact-mail"),
    "LINE": document.getElementById("contact-line"),
    "Instagram DM": document.getElementById("contact-insta")
  };
  contactRadios.forEach(radio => {
    radio.addEventListener('change', function(){
      Object.values(contactBlocks).forEach(el=>{if(el)el.classList.add('hidden')});
      if(contactBlocks[this.value]){
        contactBlocks[this.value].classList.remove('hidden');
      }
    });
  });

  // ======== 送信内容の確認モーダル ========
  const modalDiv = document.createElement('div');
  modalDiv.id = "confirm-modal";
  modalDiv.className = "hidden";
  modalDiv.innerHTML = `
    <div class="confirm-box">
      <h3>送信内容のご確認</h3>
      <div id="confirm-contents"></div>
      <button id="confirm-send" class="btn-submit">この内容で送信</button>
      <button id="confirm-cancel" class="btn-cancel">戻る</button>
    </div>
  `;
  document.body.appendChild(modalDiv);

  const form = document.querySelector('.trial-form');
  const btn = form.querySelector('.btn-submit');
  const confirmModal = document.getElementById('confirm-modal');
  const confirmContents = document.getElementById('confirm-contents');

  btn.addEventListener('click', function(){
    // HTML5バリデーション
    if (!form.checkValidity()) {
      form.reportValidity();
      return;
    }
    let html = "";
    html += "<b>お名前：</b>" + (form.lastname.value || "") + " " + (form.firstname.value || "") + "<br>";
    html += "<b>ふりがな：</b>" + (form.furigana_last.value || "") + " " + (form.furigana_first.value || "") + "<br>";
    html += "<b>年齢：</b>" + (form.age.value || "") + "<br>";
    html += "<b>性別：</b>" + (form.gender.value || "") + "<br>";
    html += "<b>希望するコース：</b>" + (form.course.value || "") + "<br>";
    // レッスン理由
    let course = form.course.value;
    if(course && reasonBlocks[course]){
      const block = reasonBlocks[course];
      const reasons = Array.from(block.querySelectorAll('input[type="checkbox"]:checked')).map(el=>el.value);
      html += "<b>レッスン理由：</b>" + (reasons.length ? reasons.join('、') : "未選択") + "<br>";
      let etc = block.querySelector('textarea');
      if(etc && etc.value) html += "<b>その他理由：</b>" + etc.value + "<br>";
    }
    // 曜日・時間
    const days = Array.from(form.querySelectorAll('input[name="weekday"]:checked')).map(el=>el.value);
    html += "<b>希望曜日：</b>" + (days.length ? days.join('、') : "未選択") + "<br>";
    if(days.length){
      days.forEach(day=>{
        const times = Array.from(form.querySelectorAll(`input[name="time_${day}"]:checked`)).map(el=>el.value);
        html += "&nbsp;&nbsp;・"+day+"：";
        html += (times.length ? times.join('、') : "（時間未選択）") + "<br>";
      });
    }
    if(form.free_request.value) html += "<b>要相談：</b>" + form.free_request.value + "<br>";
    // 連絡方法
    const cm = form.contact_method.value;
    html += "<b>ご希望の連絡方法：</b>" + cm + "<br>";
    if(cm === "電話"){
      html += "<b>お電話番号：</b>"+ (form.contact_phone_tel.value || "") + "<br>";
      const cTimes = Array.from(form.querySelectorAll('input[name="contact_phone_time"]:checked')).map(el=>el.value);
      html += "<b>ご都合の良いお時間：</b>" + (cTimes.length ? cTimes.join('、') : "未指定") + "<br>";
    }
    if(cm === "メール"){
      html += "<b>メールアドレス：</b>"+ (form.contact_mail_address.value || "") + "<br>";
    }
    if(cm === "LINE"){
      html += "<b>LINEアカウント名：</b>"+ (form.contact_line_name.value || "") + "<br>";
    }
    if(cm === "Instagram DM"){
      html += "<b>Instagramアカウント名：</b>"+ (form.contact_insta_name.value || "") + "<br>";
    }
    confirmContents.innerHTML = html;
    confirmModal.classList.remove('hidden');
  });

  confirmModal.querySelector('#confirm-cancel').addEventListener('click', function(){
    confirmModal.classList.add('hidden');
  });
  confirmModal.querySelector('#confirm-send').addEventListener('click', function(){
    form.submit();
  });
});
  </script>
  
  
  <script>
document.addEventListener('DOMContentLoaded', function() {
  const form = document.querySelector('.trial-form');
  const btn = form.querySelector('.btn-submit');
  const courseSelect = document.getElementById('course');

  // ======== リアルタイムバリデーション追加 ========
  // コース理由：コース変更・チェック時に必ず更新
  function updateReasonValidity() {
    let valid = true;
    const course = courseSelect.value;
    if (course === 'ピアノ') {
      const checks = form.querySelectorAll('[name="reason_piano"]');
      if (![...checks].some(cb => cb.checked)) {
        checks[0].setCustomValidity('選択してください');
        valid = false;
      } else {
        checks.forEach(cb => cb.setCustomValidity(''));
      }
    }
    if (course === 'ピアノ弾き語り') {
      const checks = form.querySelectorAll('[name="reason_singplay"]');
      if (![...checks].some(cb => cb.checked)) {
        checks[0].setCustomValidity('選択してください');
        valid = false;
      } else {
        checks.forEach(cb => cb.setCustomValidity(''));
      }
    }
    if (course === 'ボイストレーニング') {
      const checks = form.querySelectorAll('[name="reason_voice"]');
      if (![...checks].some(cb => cb.checked)) {
        checks[0].setCustomValidity('選択してください');
        valid = false;
      } else {
        checks.forEach(cb => cb.setCustomValidity(''));
      }
    }
    return valid;
  }
  // 曜日・時間帯
  function updateWeekdayValidity() {
    const checks = form.querySelectorAll('[name="weekday"]');
    if (![...checks].some(cb => cb.checked)) {
      checks[0].setCustomValidity('選択してください');
      return false;
    } else {
      checks.forEach(cb => cb.setCustomValidity(''));
    }
    // 各曜日で時間帯も必須（最低1つ）
    let valid = true;
    form.querySelectorAll('[name="weekday"]:checked').forEach(cb => {
      const times = form.querySelectorAll(`input[name="time_${cb.value}"]`);
      if (![...times].some(tb => tb.checked)) {
        times[0].setCustomValidity('選択してください');
        valid = false;
      } else {
        times.forEach(tb => tb.setCustomValidity(''));
      }
    });
    return valid;
  }
  // 連絡方法ごとの個別必須
  function updateContactValidity() {
    const method = form.contact_method.value;
    let valid = true;
    if (method === '電話' && !form.contact_phone_tel.value) {
      form.contact_phone_tel.setCustomValidity('入力してください');
      valid = false;
    } else if (form.contact_phone_tel) {
      form.contact_phone_tel.setCustomValidity('');
    }
    if (method === 'メール' && !form.contact_mail_address.value) {
      form.contact_mail_address.setCustomValidity('入力してください');
      valid = false;
    } else if (form.contact_mail_address) {
      form.contact_mail_address.setCustomValidity('');
    }
    if (method === 'LINE' && !form.contact_line_name.value) {
      form.contact_line_name.setCustomValidity('入力してください');
      valid = false;
    } else if (form.contact_line_name) {
      form.contact_line_name.setCustomValidity('');
    }
    if (method === 'Instagram DM' && !form.contact_insta_name.value) {
      form.contact_insta_name.setCustomValidity('入力してください');
      valid = false;
    } else if (form.contact_insta_name) {
      form.contact_insta_name.setCustomValidity('');
    }
    return valid;
  }

  // イベントハンドラ登録
  // コース理由
  ['reason_piano', 'reason_singplay', 'reason_voice'].forEach(name => {
    form.querySelectorAll(`[name="${name}"]`).forEach(cb => {
      cb.addEventListener('change', updateReasonValidity);
    });
  });
  courseSelect.addEventListener('change', updateReasonValidity);

  // 曜日
  form.querySelectorAll('[name="weekday"]').forEach(cb => {
    cb.addEventListener('change', updateWeekdayValidity);
  });
  // 時間帯（曜日選択時に生成される場合は生成後にもイベント付与が必要）

  // 連絡方法
  form.querySelectorAll('[name="contact_method"]').forEach(radio => {
    radio.addEventListener('change', updateContactValidity);
  });
  ['contact_phone_tel','contact_mail_address','contact_line_name','contact_insta_name'].forEach(id=>{
    const el = form[id];
    if(el) el.addEventListener('input', updateContactValidity);
  });

  // 「確認」ボタン/submit時
  btn.addEventListener('click', function(e){
    // すべてのバリデーションを明示的に走らせる
    const valid =
      updateReasonValidity() &
      updateWeekdayValidity() &
      updateContactValidity();
    if (!form.checkValidity() || !valid) {
      form.reportValidity();
      return;
    }
    // ... ここから下はモーダル表示ロジック ...
  });

  // form submitも同じ
  form.addEventListener('submit', function(e) {
    const valid =
      updateReasonValidity() &
      updateWeekdayValidity() &
      updateContactValidity();
    if (!form.checkValidity() || !valid) {
      e.preventDefault();
      form.reportValidity();
    }
  });
});
  </script>
  
  
</body>
</html>